<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="../../common/js/mobile.js"></script>
    <script src="../js/iconfont.js"></script>
    <link rel="stylesheet" href="../../common/consumer/css/common.css">
    <link rel="stylesheet" href="../css/xf-sjinfo.css">
    <title>Document</title>
</head>

<body>
    <header>
        <div id="header">
            <!-- <a href="#"> -->
            <svg id="icon" class="icon" aria-hidden="true">
                <use xlink:href="#icon-zuojiantou"></use>
            </svg>
            <p id="address">连咖啡Coffee Box</p>
            <!-- </a> -->
        </div>
    </header>

    <div id="tab">
        <ul id="nav">
            <li>点餐</li>
            <li>评价</li>
            <li>商家</li>
        </ul>
        <div id="info">
            <!-- 点餐开始 -->
            <div class="dian">
                <!-- 左侧 菜品分类 -->
                <ul id="caiStyle">
                    <!-- 动态添加菜品分类 -->
                </ul>
            <!--include virtual="html/goods.html"-->
            <section id="section">
                <!-- <div class="9">
                    <a class="target" name="9"></a>
                    <span>
                        <a>热销</a>
                    </span>
                    <div id="goods">
                        <img src="../img/coffee1.webp" alt="coffe">
                        <div class="aside">
                            <h5>防弹咖啡</h5>
                            <p>月售99份 好评率100%</p>
                            <p>￥35</p>
                            <div class="num">
                                <button id="reduce">-</button>
                                <input id="sum" type="text" value="0">
                                <button id="plus">+</button>
                            </div>
                        </div>
                    </div>
                </div> -->
                
            </section>
            </div>
            <!-- 点餐结束 -->
            <!-- 评价 -->
            <div class="ping">
                <div class="lei">
                    <button id="all">全部<span>234</span></button>
                    <button id="manyi">满意<span>234</span></button>
                    <button id="buman">不满意<span>10</span></button>
                    <button id="youtu">有图<span>13</span></button>
                </div>
                <div class="assess">
                    <img id="header" class="header" src="../img/header.webp"></img>
                    <div class="uinfo">
                        <p id="user" class="user">匿名用户</p>
                        <p id="time" class="time">2018-04-01</p>
                        <p id="attitude" class="attitude">满意</p>
                    </div>
                    <div class="assess-info">
                        <p>包装很干净，咖啡味道不错</p>
                        <img src="../img/assess-img1.webp" alt="" id="assess-img" class="assess-img">
                        <img src="../img/assess-img2.webp" alt="" id="assess-img" class="assess-img">
                        <img src="../img/assess-img3.webp" alt="" id="assess-img" class="assess-img">
                    </div>
                </div>
                <div class="assess">
                    <img id="header" class="header" src="../img/header.webp"></img>
                    <div class="uinfo">
                        <p id="user" class="user">匿名用户</p>
                        <p id="time" class="time">2018-04-01</p>
                        <p id="attitude" class="attitude">满意</p>
                    </div>
                    <div class="assess-info">
                        <p>包装很干净，咖啡味道不错</p>
                        <img src="../img/assess-img1.webp" alt="" id="assess-img" class="assess-img">
                        <img src="../img/assess-img2.webp" alt="" id="assess-img" class="assess-img">
                        <img src="../img/assess-img3.webp" alt="" id="assess-img" class="assess-img">
                    </div>
                </div>
            </div>
            <!-- 商家信息 -->
            <div class="shang">
                <ul class="sjInfo">
                    <li><span>商家名称</span><span>连咖啡Coffee Box</span></li>
                    <li><span>商家信息</span><span>暂无简介</span></li>
                    <li><span>品类</span><span>咖啡</span></li>
                    <li><span>商家电话</span><span>18733507863</span></li>
                    <li><span>地址</span><span>上海市黄浦区南京东路300号</span></li>
                    <li><span>营业时间</span><span>08:30-17:30</span></li>
                    <li><span>营业资质</span><span>></span></li>
                    <li><a id="report" href="xf-report.html">举报商家</a></li>
                </ul>
            </div>
            
        </div>
    </div>
    <footer>
        
    </footer>
</body>
<script src="../../common/js/addevent.js"></script>
<script src="../../common/js/ajax.js"></script>
<script src="../../business/js/jquery-1.11.1.js"></script>
<script>
    addEvent(window, 'load', () => {
        let $ = id => { return document.getElementById(id) };
        let nav = $("nav");
        let info = $("info");
        let section=$("section");
        let caiStyle=$("caiStyle");
        // 请求菜品分类信息
        ajax("POST","../../common/php/goodstyle.php",returnData=>{
            let arr= returnData.split(";");
            for(let i =0,len=arr.length-1;i<len;i++){
                let json=JSON.parse(arr[i]);
                caiStyle.innerHTML+="<li><a href='#"+json.styleId+"'>"+json.styleName+"</a></li>";
                section.innerHTML += "<div class=cid'"+ json.styleId+"' ><a class='target' name='" + json.styleId + "'></a><span><a>" + json.styleName + "</a></span></div>"
            }
        },"JSON");
        //  请求菜品信息
        ajax("POST", "../../common/php/goodsinfo.php", returnData => {
            let arr = returnData.split(";");
            let json = JSON.parse(arr[0]);
            let str = json.styleName;
            let newstr="";
            for (let i = 0, len = arr.length - 1; i < len; i++) {
                let json = JSON.parse(arr[i]);
                    console.log(json)
                
                if(str==json.styleName){
                
                // newstr+="<div id='goods'><img src='./../../business/php/upload/"+json.caiImg+"' ><div class='aside'><h5>"+ json.caiName+"</h5><p>月售99份 好评率100%</p><p>￥"+ json.caiPrice+"</p><div class='num'><button id='reduce'>-</button><input id='sum' name='dt_num' type='text' value='0'><button id='plus' >+</button></div></div></div>";
                    // $("div[class^='cid']").attr("id","45679")
                    // console.log(newstr)
                    // document.getElementsByClassName(json.styleId).innerHTML="465465"
                }else{
                    // str=json.styleName;
                // newstr += "<div id='goods'><img src='./../../business/php/upload/" + json.caiImg + "' ><div class='aside'><h5>" + json.caiName + "</h5><p>月售99份 好评率100%</p><p>￥" + json.caiPrice + "</p><div class='num'><button id='reduce'>-</button><input id='sum' name='dt_num' type='text' value='0'><button id='plus' >+</button></div></div></div>";
                    
                    
                    // str=json.styleName;
                    // newarr.push(json)
                }
            };
        }, "JSON");
        // tab菜单
        hidden();
        function hidden(){
            for(let i =0;i<info.children.length;i++){
                info.children[i].style.display="none";
                // section[i].style.display="none";
                nav.children[i].style.cssText = "border-bottom:2px solid #fff";
            }
        }
        info.children[0].style.display="block";
        nav.children[0].style.cssText = "border-bottom:2px solid #00a7ff";
        for (let i=0;i<nav.children.length;i++){
            (function(i){
                nav.children[i].onclick = function () {
                    hidden();
                    info.children[i].style.display = "block";
                    nav.children[i].style.cssText="border-bottom:2px solid #00a7ff";
                }
            })(i);
        };
        // 商品数量增减
        let reduce=$('reduce');
        let sum=$('sum');
        let plus=$('plus');
        // let num = Number(sum.value);
        
        // addEvent(plus,"click",()=>{
        //     num+=1;
        //     sum.value=num;
        //     if(num>=1){
        //         reduce.style.opacity='1';
        //         sum.style.opacity = "1"
        //     }
        // });
        //商品数量减少
        // addEvent(reduce,"click",()=>{
        //     num-=1;
        //     sum.value=num;
        //     if(num<1){
        //         num=0;
        //         reduce.style.opacity="0";
        //         sum.style.opacity="0";
        //     }
        // });
        // 左上角返回
        let icon=$("icon");
        addEvent(icon,"click",()=>{
            history.go(-1);
        });
    })
    // 添加 减少 事件
    $(function () {
        $("#section").on("click", "#plus", function (e) {
            var num = Number($("#sum").val());
            num=num+1;
            $("#sum").val(num)
            if(num>0){
                $("#reduce").css("opacity","1");
                $("#sum").css("opacity", "1");
            }
            console.log($("#sum").val())
        })
    })
</script>

</html>